{"version":2,"kind":"Notebook","sha256":"84e71147931ffb6521d4f551446b904d3bcf2876fabc093e471c32f63004ad2e","slug":"tedetoku-kadai-1-4-1","location":"/tedetoku-kadai-1-4-1.ipynb","dependencies":[],"frontmatter":{"title":"対象分子の設定","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"py311","language":"python"},"jupytext":{"formats":"ipynb,py:percent"},"authors":[{"id":"yu9824","name":"yu9824"}],"github":"https://github.com/yu9824/tedetoku-ryoushikagaku","source_url":"https://github.com/yu9824/tedetoku-ryoushikagaku/blob/main/tedetoku-kadai-1-4-1.ipynb","edit_url":"https://github.com/yu9824/tedetoku-ryoushikagaku/edit/main/tedetoku-kadai-1-4-1.ipynb","exports":[{"format":"ipynb","filename":"tedetoku-kadai-1-4-1.ipynb","url":"/build/tedetoku-kadai-1-4-1-adf4e6d1474891a860ca713cb2534672.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"blockquote","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"He およびＨの核座標がそれぞれ (0, 0, 0)， (0, 0, 1.4) （bohr単位） のとき， HeH＋  の基底状態 （1σ2） に対する RHF波動関数とRHF エネルギーを求めよ． 基底関数は  STO-NG (N＝1, 2, 3, 4, 5, 6) のいずれかとして， 付録の HeH系の分子積分の値を用  いよ． SCF の収束判定は， エネルギーについてのみ行い， 閾値は 0.0001 hartree とせ  よ． また， 得られた RHF波動関数を用いて Mulliken の電子密度解析を行い， He お  よびＨ原子の電荷を求めよ．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hSrLIP8GXi"}],"key":"sWiqHovaPl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"中井浩巳. 手で解く量子化学 I (p. 86). (Function). Kindle Edition.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mVn9a94ftu"}],"key":"OGwLHa8VTH"}],"key":"ysNa8Pv95c"}],"key":"SXxxpduPWe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"基底関数は、STO-6Gとする。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fyW7kcXWQK"}],"key":"DtKnopQ3yD"}],"key":"ZKucglw4nG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from types import MappingProxyType\nfrom itertools import product\n\nimport numpy as np\nfrom scipy.linalg import ishermitian","key":"yfvx1Yobgs"},{"type":"output","id":"1dUykgfQRg0KPsP-SkIW0","data":[],"key":"gmC4IJhX0q"}],"key":"SG281KnEew"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"対象分子の設定","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tfTh21Wb7n"}],"identifier":"id","label":"対象分子の設定","html_id":"id","implicit":true,"key":"iGZvK0woeF"}],"key":"x4BAZM1JOY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"核電荷","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KImSI7Laqe"},{"type":"inlineMath","value":"Z_\\mathrm{He}=2.0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi mathvariant=\"normal\">H</mi><mi mathvariant=\"normal\">e</mi></mrow></msub><mo>=</mo><mn>2.0</mn></mrow><annotation encoding=\"application/x-tex\">Z_\\mathrm{He}=2.0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">He</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.0</span></span></span></span>","key":"NseNaDwx0B"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zfYQpgiv4h"},{"type":"inlineMath","value":"Z_\\mathrm{H}=1.0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mi mathvariant=\"normal\">H</mi></msub><mo>=</mo><mn>1.0</mn></mrow><annotation encoding=\"application/x-tex\">Z_\\mathrm{H}=1.0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathrm mtight\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.0</span></span></span></span>","key":"sXK920vNIa"},{"type":"text","value":", 核座標","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MjDMP1Ix1A"},{"type":"inlineMath","value":"\\boldsymbol{R}_\\mathrm{He}=(0.0, 0.0, 0.0)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold-italic\">R</mi><mrow><mi mathvariant=\"normal\">H</mi><mi mathvariant=\"normal\">e</mi></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.0</mn><mo separator=\"true\">,</mo><mn>0.0</mn><mo separator=\"true\">,</mo><mn>0.0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{R}_\\mathrm{He}=(0.0, 0.0, 0.0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.00421em;\">R</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">He</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.0</span><span class=\"mclose\">)</span></span></span></span>","key":"X9L9MdCJFL"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gZq1VKNxuo"},{"type":"inlineMath","value":"\\boldsymbol{R}_\\mathrm{H}=(0.0, 0.0, 1.4)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold-italic\">R</mi><mi mathvariant=\"normal\">H</mi></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.0</mn><mo separator=\"true\">,</mo><mn>0.0</mn><mo separator=\"true\">,</mo><mn>1.4</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{R}_\\mathrm{H}=(0.0, 0.0, 1.4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.00421em;\">R</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathrm mtight\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1.4</span><span class=\"mclose\">)</span></span></span></span>","key":"L9DhkvKgC9"},{"type":"text","value":"より、核反発エネルギー","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IRvfgVkbCb"}],"key":"lXQ9MR2jRa"}],"key":"LhesE4Rf2r"},{"type":"block","kind":"notebook-content","children":[{"type":"math","value":"V_\\mathrm{nuc} = \\sum_{A=1}^M \\sum_{B>A}^M \\frac{Z_A Z_B}{R_{AB}}   \\tag{3.2}","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><msub><mi>V</mi><mrow><mi mathvariant=\"normal\">n</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">c</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>A</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><munderover><mo>∑</mo><mrow><mi>B</mi><mo>&gt;</mo><mi>A</mi></mrow><mi>M</mi></munderover><mfrac><mrow><msub><mi>Z</mi><mi>A</mi></msub><msub><mi>Z</mi><mi>B</mi></msub></mrow><msub><mi>R</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mfrac></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(3.2)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">V_\\mathrm{nuc} = \\sum_{A=1}^M \\sum_{B&gt;A}^M \\frac{Z_A Z_B}{R_{AB}}   \\tag{3.2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">nuc</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.15em;vertical-align:-1.3217em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8557em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">A</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2943em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8557em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05017em;\">B</span><span class=\"mrel mtight\">&gt;</span><span class=\"mord mathnormal mtight\">A</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3217em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"tag\"><span class=\"strut\" style=\"height:3.15em;vertical-align:-1.3217em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">3.2</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"1","key":"skDUEHDMN9"}],"key":"i9ogWQBxfv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Z_He = 2.0\n\"\"\"Heの核電荷\"\"\"\nZ_H = 1.0\n\"\"\"Hの核電荷\"\"\"","key":"JYIUluTVmV"},{"type":"output","id":"WNkFRu8t2VFOV-zfUNmmU","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"'Hの核電荷'","content_type":"text/plain"}}}],"key":"Ysv5phqfAh"}],"key":"Blz7NwilGJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"V_nuc = (Z_He * Z_H) / 1.4\n\"\"\"核間のポテンシャルエネルギー\"\"\"\nV_nuc","key":"X8OpvuPemX"},{"type":"output","id":"c77vqPpUmL6X9mzognQxy","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"1.4285714285714286","content_type":"text/plain"}}}],"key":"FNvfGSbxJx"}],"key":"xPbgFaldzQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"正準直行化の実行","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EUT7v3fCxA"}],"identifier":"id","label":"正準直行化の実行","html_id":"id-1","implicit":true,"key":"ueIm2X3h1t"}],"key":"m7m3sTGYHG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"S = np.array([[1.0, 0.56059], [0.56059, 1.0]])\n\"\"\"重なり行列 (付録より)\"\"\"\nS","key":"lgEiEH85aF"},{"type":"output","id":"jSdNvtaqOzciO3Ka2Rgjx","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"array([[1.     , 0.56059],\n       [0.56059, 1.     ]])","content_type":"text/plain"}}}],"key":"UPQUQKi74t"}],"key":"My5Vn9waO4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def unitary_diagonalization(arr: np.ndarray) -> tuple[np.ndarray, np.ndarray]:\n    \"\"\"ユニタリ対角化関数\n\n    Parameters\n    ----------\n    arr : np.ndarray\n        対角化する行列\n\n    Returns\n    -------\n    tuple[np.ndarray, np.ndarray]\n        対角化された行列とユニタリ行列\n\n    Raises\n    ------\n    ValueError\n        エルミート行列でない場合\n    \"\"\"\n    if ishermitian(arr, rtol=1e-05, atol=1e-08):\n        # エルミート行列の固有ベクトル\n        _, u = np.linalg.eigh(arr)\n\n        # Uの随伴行列(共役転置)\n        u_dagger = np.conjugate(u.T)\n\n        # エルミート行列をユニタリ行列で対角化\n        diag_matrix = u_dagger @ arr @ u\n\n        # データ型を整数に変更して小さな誤差が入っている虚部を取り除く\n        # 単位行列をかけて対角成分以外の要素の誤差を小さくする\n        diag_matrix = diag_matrix.astype(np.float64) * np.identity(\n            arr.shape[0], dtype=np.float64\n        )\n\n        return diag_matrix, u\n    else:\n        raise ValueError(\"The matrix is not Hermitian.\")\n\n\ns, U = unitary_diagonalization(S)\n\"\"\"s: 固有値\nU: 固有ベクトル\"\"\"\nprint(f\"{s=}\")\nprint(f\"{U=}\")","key":"ZN9iOfFdQG"},{"type":"output","id":"mr9fSWgdw80NHrpaufGaK","data":[{"name":"stdout","output_type":"stream","text":"s=array([[ 0.43941,  0.     ],\n       [-0.     ,  1.56059]])\nU=array([[-0.70710678,  0.70710678],\n       [ 0.70710678,  0.70710678]])\n"}],"key":"RSPjpnjRv6"}],"key":"ltJFdcU9df"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"正準直交化の変換行列 ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l3udPYo3i4"},{"type":"inlineMath","value":"X","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>","key":"cjsUbQEOlx"},{"type":"text","value":" は、","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gzWySjTF39"}],"key":"kjPDnhJayQ"},{"type":"math","value":"X_\\mathrm{can} = U s^{-\\frac{1}{2}} \\tag{4.36}","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><msub><mi>X</mi><mrow><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">n</mi></mrow></msub><mo>=</mo><mi>U</mi><msup><mi>s</mi><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(4.36)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">X_\\mathrm{can} = U s^{-\\frac{1}{2}} \\tag{4.36}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">can</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.004em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.004em;\"><span style=\"top:-3.413em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"strut\" style=\"height:1.254em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">4.36</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"2","key":"RfoQZzentA"}],"key":"ybpEZlE82e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 行列を^(-1/2)する。'-' は逆行列の意味\ndef inverse_sqrt_matrix(arr: np.ndarray) -> np.ndarray:\n    \"\"\"行列の^(-1/2)を計算する関数\n\n    Parameters\n    ----------\n    arr : np.ndarray\n        ^(-1/2)を計算する行列\n\n    Returns\n    -------\n    np.ndarray\n        ^(-1/2)された行列\n    \"\"\"\n    return np.linalg.inv(np.sqrt(arr))\n\n\ninverse_sqrt_matrix(s)","key":"kcYXiQQMK8"},{"type":"output","id":"kZFTHlphPK3cG4b4H3Ymq","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"array([[1.50856849, 0.        ],\n       [0.        , 0.80048941]])","content_type":"text/plain"}}}],"key":"vQLEDEFgRX"}],"key":"dp9thMudGR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"X = U @ inverse_sqrt_matrix(s)\n\"\"\"正準直行化の変換行列\"\"\"\nX","key":"Dp4b4s695A"},{"type":"output","id":"VVGe-YP_M9y9GXvrM2uVv","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"array([[-1.06671901,  0.56603149],\n       [ 1.06671901,  0.56603149]])","content_type":"text/plain"}}}],"key":"hffHVHDty8"}],"key":"PHcugFJ2Mf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"コアハミルトニアン行列の計算","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oQwzR6dK8G"}],"identifier":"id","label":"コアハミルトニアン行列の計算","html_id":"id-2","implicit":true,"key":"AeIbK9ankl"}],"key":"jp7hK4CQxA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"H = np.array([[-2.6444, -1.5118], [-1.5118, -1.7782]])\n\"\"\"コアハミルトニアン行列 (付録より)\"\"\"\nH","key":"u060oIFfSP"},{"type":"output","id":"bt975Rzg5YqSt89L11Rl7","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"array([[-2.6444, -1.5118],\n       [-1.5118, -1.7782]])","content_type":"text/plain"}}}],"key":"Wv47SLq78W"}],"key":"CXRigJiN1Z"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"密度行列の初期値","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CasmQfSVf5"}],"identifier":"id","label":"密度行列の初期値","html_id":"id-3","implicit":true,"key":"YPKh9BjnM2"}],"key":"iQAQt9T13K"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"直行化基底に対するコアハミルトン行列 ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ETK16WuY6P"},{"type":"inlineMath","value":"H'","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>H</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">H&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"EMSbnLPcD6"},{"type":"text","value":" は、","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LXydKQzydX"}],"key":"f5ArdomEMo"},{"type":"math","value":"H'=X^T HX   \\tag{4.2}","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><msup><mi>H</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mi>H</mi><mi>X</mi></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(4.2)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">H&#x27;=X^T HX   \\tag{4.2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span><span class=\"tag\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">4.2</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"3","key":"eh1zG1etCq"}],"key":"CnyEQ72ods"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"H_prime = X.T @ H @ X\n\"\"\"正準直交化基底に対するコアハミルトニアン行列\"\"\"\nH_prime","key":"TBS6JE4lHL"},{"type":"output","id":"m3cEZrgx_KfuILHoAJE2k","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"array([[-1.59190733,  0.52300857],\n       [ 0.52300857, -2.38570028]])","content_type":"text/plain"}}}],"key":"K6WoaOJKMs"}],"key":"fXQZnvGBI6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"_, C_prime = unitary_diagonalization(H_prime)\n\"\"\"正準直交化基底に対する分子軌道係数行列\"\"\"\nC_prime","key":"BXY8oqZdgu"},{"type":"output","id":"S3_9HSeSyTRz4jR4rYryH","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"array([[-0.44468334, -0.89568785],\n       [ 0.89568785, -0.44468334]])","content_type":"text/plain"}}}],"key":"OZbBDLhsbU"}],"key":"x1E7nR9zPJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"C = X @ C_prime\n\"\"\"分子軌道係数行列\"\"\"\nC","key":"M2dbUflsSt"},{"type":"output","id":"gzHLeoyMZ3A8kbO4vTAvV","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"array([[ 0.9813397 ,  0.70374249],\n       [ 0.03263536, -1.20715203]])","content_type":"text/plain"}}}],"key":"BnVWwzRqUg"}],"key":"pgUrU6j0ZE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"密度行列 ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I98eUC1Yk4"},{"type":"inlineMath","value":"\\boldsymbol{P}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold-italic\">P</mi></mrow><annotation encoding=\"application/x-tex\">\\boldsymbol{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.15972em;\">P</span></span></span></span></span></span>","key":"UqRBLd5LdP"},{"type":"text","value":" は、","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lrxE769bjP"}],"key":"DSLwuovcns"},{"type":"math","value":"P_{\\mu\\nu} = 2 \\sum_{i} c_{\\mu i}^* c_{\\nu i} \\tag{4.19}","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><msub><mi>P</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub><mo>=</mo><mn>2</mn><munder><mo>∑</mo><mi>i</mi></munder><msubsup><mi>c</mi><mrow><mi>μ</mi><mi>i</mi></mrow><mo>∗</mo></msubsup><msub><mi>c</mi><mrow><mi>ν</mi><mi>i</mi></mrow></msub></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(4.19)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">P_{\\mu\\nu} = 2 \\sum_{i} c_{\\mu i}^* c_{\\nu i} \\tag{4.19}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3277em;vertical-align:-1.2777em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">μ</span><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">ν</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"strut\" style=\"height:2.3277em;vertical-align:-1.2777em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">4.19</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"4","key":"tReRGj5M0f"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineMath","value":"i","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"wJtCJ9kWN6"},{"type":"text","value":"は、分子軌道の足、","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"teSKTQToWb"},{"type":"inlineMath","value":"\\mu, \\nu","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi><mo separator=\"true\">,</mo><mi>ν</mi></mrow><annotation encoding=\"application/x-tex\">\\mu, \\nu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.06366em;\">ν</span></span></span></span>","key":"OLtlEAAF6c"},{"type":"text","value":"は原子軌道の足","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ugcyJpcMkl"}],"key":"X8tXQBbhBH"}],"key":"oHQ4SyCvuZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HeH+ では、占有軌道 ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k48BbnTZb1"},{"type":"inlineMath","value":"\\varphi_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>φ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\varphi_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">φ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"EXPP8vhsr3"},{"type":"text","value":" だけなので、 (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nyISdOrFaB"},{"type":"inlineMath","value":"1\\sigma","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">1\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"X4OTfw5rHA"},{"type":"text","value":" 軌道だけという意味と解釈)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MtByrNjmtX"}],"key":"ljU5Q9tI6a"}],"key":"fhoYdrtJg2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def calculate_density_matrix(C: np.ndarray) -> np.ndarray:\n    \"\"\"密度行列を計算する関数\n\n    Parameters\n    ----------\n    C : np.ndarray\n        分子軌道係数行列\n\n    Returns\n    -------\n    np.ndarray\n        密度行列\n    \"\"\"\n    return 2 * (C[:, [0]] @ C[:, [0]].T)\n\n\nP = calculate_density_matrix(C)\n\"\"\"密度行列\"\"\"\nP","key":"L4BkfsaWU8"},{"type":"output","id":"T60AB3Bvot4fX1kt70Xu5","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"array([[1.92605521, 0.06405275],\n       [0.06405275, 0.00213013]])","content_type":"text/plain"}}}],"key":"udETsqV3wX"}],"key":"zi5ozkom6z"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"電子反発積分の計算","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vwGb3uvF0R"}],"identifier":"id","label":"電子反発積分の計算","html_id":"id-4","implicit":true,"key":"gsKy7ZVYKj"}],"key":"Wc6xOQwjdq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"MAP_ELECTRON_REPULSION_INTEGRAL = MappingProxyType(\n    {\n        ((1, 1), (1, 1)): 1.05625,\n        ((1, 1), (1, 2)): 0.46768,\n        ((1, 1), (2, 1)): 0.46768,\n        ((1, 1), (2, 2)): 0.60640,\n        ((1, 2), (1, 1)): 0.46768,\n        ((1, 2), (1, 2)): 0.24649,\n        ((1, 2), (2, 1)): 0.24649,\n        ((1, 2), (2, 2)): 0.38871,\n        ((2, 1), (1, 1)): 0.46768,\n        ((2, 1), (1, 2)): 0.24649,\n        ((2, 1), (2, 1)): 0.24649,\n        ((2, 1), (2, 2)): 0.38871,\n        ((2, 2), (1, 1)): 0.60640,\n        ((2, 2), (1, 2)): 0.38871,\n        ((2, 2), (2, 1)): 0.38871,\n        ((2, 2), (2, 2)): 0.77500,\n    }\n)\n\"\"\"電子反発積分 (付録より)\"\"\"\nNone","key":"rffk3YkmTy"},{"type":"output","id":"VJyIj5D1zcrHJJSQS0PyA","data":[],"key":"lDXqfQv7Fa"}],"key":"dUxPN2CTPI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fock行列の計算","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r9UnRQwGhW"}],"identifier":"fock","label":"Fock行列の計算","html_id":"fock","implicit":true,"key":"R9G2i3QPM1"}],"key":"WYbJ1w42va"},{"type":"block","kind":"notebook-content","children":[{"type":"math","value":"F_{\\mu \\nu} = H_{\\mu \\nu} + G_{\\mu \\nu} \\tag{4.3} \\\\","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><msub><mi>F</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub><mo>=</mo><msub><mi>H</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub><mo>+</mo><msub><mi>G</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub><mspace linebreak=\"newline\"></mspace></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(4.3)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">F_{\\mu \\nu} = H_{\\mu \\nu} + G_{\\mu \\nu} \\tag{4.3} \\\\</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span><span class=\"mspace newline\"></span><span class=\"tag\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">4.3</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"5","key":"sv441Nt0sr"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineMath","value":"H_{\\mu \\nu}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">H_{\\mu \\nu}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RwEsxc7CrF"},{"type":"text","value":" は、","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"x2xA2QtAzd"},{"type":"link","url":"#%E3%82%B3%E3%82%A2%E3%83%8F%E3%83%9F%E3%83%AB%E3%83%88%E3%83%8B%E3%82%A2%E3%83%B3%E8%A1%8C%E5%88%97%E3%81%AE%E8%A8%88%E7%AE%97","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"先ほど","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"p6y4fmVs7E"}],"urlSource":"#%E3%82%B3%E3%82%A2%E3%83%8F%E3%83%9F%E3%83%AB%E3%83%88%E3%83%8B%E3%82%A2%E3%83%B3%E8%A1%8C%E5%88%97%E3%81%AE%E8%A8%88%E7%AE%97","key":"ylZfNxJoSw"},{"type":"text","value":"求めているので、","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IYScJeNe6v"},{"type":"inlineMath","value":"G_{\\mu \\nu}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>G</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">G_{\\mu \\nu}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xq9uaU6bou"},{"type":"text","value":" を求めたい。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IN8hoBLi7Q"}],"key":"qQHhSlpqlY"},{"type":"math","value":"\\begin{align*}\n    J_{\\mu \\nu} &= \\sum_{\\lambda, \\sigma} (\\mu \\nu | \\lambda \\sigma) P_{\\lambda \\sigma} \\tag{4.25} \\\\\n    K_{\\mu \\nu} &= \\sum_{\\lambda, \\sigma} (\\mu \\sigma | \\lambda \\nu) P_{\\lambda \\sigma} \\tag{4.26} \\\\\n    G_{\\mu \\nu} &= J_{\\mu \\nu} - \\frac{1}{2} K_{\\mu \\nu} \\tag{4.27} \\\\\n\\end{align*}","position":{"start":{"line":7,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>J</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>λ</mi><mo separator=\"true\">,</mo><mi>σ</mi></mrow></munder><mo stretchy=\"false\">(</mo><mi>μ</mi><mi>ν</mi><mi mathvariant=\"normal\">∣</mi><mi>λ</mi><mi>σ</mi><mo stretchy=\"false\">)</mo><msub><mi>P</mi><mrow><mi>λ</mi><mi>σ</mi></mrow></msub></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>K</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>λ</mi><mo separator=\"true\">,</mo><mi>σ</mi></mrow></munder><mo stretchy=\"false\">(</mo><mi>μ</mi><mi>σ</mi><mi mathvariant=\"normal\">∣</mi><mi>λ</mi><mi>ν</mi><mo stretchy=\"false\">)</mo><msub><mi>P</mi><mrow><mi>λ</mi><mi>σ</mi></mrow></msub></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>G</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>J</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>K</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\n    J_{\\mu \\nu} &amp;= \\sum_{\\lambda, \\sigma} (\\mu \\nu | \\lambda \\sigma) P_{\\lambda \\sigma} \\tag{4.25} \\\\\n    K_{\\mu \\nu} &amp;= \\sum_{\\lambda, \\sigma} (\\mu \\sigma | \\lambda \\nu) P_{\\lambda \\sigma} \\tag{4.26} \\\\\n    G_{\\mu \\nu} &amp;= J_{\\mu \\nu} - \\frac{1}{2} K_{\\mu \\nu} \\tag{4.27} \\\\\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.8839em;vertical-align:-3.6919em;\"></span><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1919em;\"><span style=\"top:-6.4634em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.6752em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-0.6155em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6919em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1919em;\"><span style=\"top:-6.4634em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">λ</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">σ</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4382em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.06366em;\">μν</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">λσ</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">λσ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.6752em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">λ</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">σ</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4382em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">μ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.06366em;\">ν</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">λσ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-0.6155em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6919em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1919em;\"><span style=\"top:-6.4634em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">4.25</span></span><span class=\"mord\">)</span></span></span></span><span style=\"top:-3.6752em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">4.26</span></span><span class=\"mord\">)</span></span></span></span><span style=\"top:-0.6155em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">4.27</span></span><span class=\"mord\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6919em;\"><span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"MnDHNR4lPw"}],"key":"o2XI4T5ciC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def calculate_coulomb_energy_matrix(P: np.ndarray) -> np.ndarray:\n    \"\"\"クーロンエネルギー行列を計算する関数\n\n    Parameters\n    ----------\n    P : np.ndarray\n        密度行列\n\n    Returns\n    -------\n    np.ndarray\n        クーロンエネルギー行列\n    \"\"\"\n    return np.array(\n        [\n            [\n                sum(\n                    MAP_ELECTRON_REPULSION_INTEGRAL[\n                        (_mu, _nu), (_lambda, _sigma)\n                    ]\n                    * P[_lambda - 1, _sigma - 1]  # Pは0-indexedなので-1する\n                    for _lambda, _sigma in product((1, 2), repeat=2)\n                )\n                for _nu in (1, 2)\n            ]\n            for _mu in (1, 2)\n        ]\n    )\n\n\nJ = calculate_coulomb_energy_matrix(P)\n\"\"\"クーロンエネルギー行列\"\"\"\nJ","key":"GpERNHNWD3"},{"type":"output","id":"4Fp3pV3yp8gTuJnQfparc","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"array([[2.0955999 , 0.93318223],\n       [0.93318223, 1.21940662]])","content_type":"text/plain"}}}],"key":"pegzee4J1X"}],"key":"HF9aK4cvRD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def calculate_exchange_energy_matrix(P: np.ndarray) -> np.ndarray:\n    \"\"\"交換エネルギー行列を計算する関数\n\n    Parameters\n    ----------\n    P : np.ndarray\n        密度行列\n\n    Returns\n    -------\n    np.ndarray\n        交換エネルギー行列\n    \"\"\"\n    return np.array(\n        [\n            [\n                sum(\n                    MAP_ELECTRON_REPULSION_INTEGRAL[\n                        (_mu, _sigma), (_lambda, _nu)\n                    ]\n                    * P[_lambda - 1, _sigma - 1]  # Pは0-indexedなので-1する\n                    for _lambda, _sigma in product((1, 2), repeat=2)\n                )\n                for _nu in (1, 2)\n            ]\n            for _mu in (1, 2)\n        ]\n    )\n\n\nK = calculate_exchange_energy_matrix(P)\n\"\"\"交換エネルギー行列\"\"\"\nK","key":"b3w4y9NdVV"},{"type":"output","id":"CJPF8lzPFFpDkMjUmlhnY","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"array([[2.09483325, 0.95623545],\n       [0.95623545, 0.52620009]])","content_type":"text/plain"}}}],"key":"PZHif9gOOz"}],"key":"O5QfeabzfD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"G = J - 0.5 * K\n\"\"\"2電子積分行列\"\"\"\nG","key":"yzPEKi92NS"},{"type":"output","id":"xZ4OX3cFLK-7UXWH414kq","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"array([[1.04818328, 0.4550645 ],\n       [0.4550645 , 0.95630657]])","content_type":"text/plain"}}}],"key":"DyGoPmlO0g"}],"key":"iTau0dzdVQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"F = H + G\n\"\"\"Fock行列\"\"\"\nF","key":"Epet4rLHxk"},{"type":"output","id":"8mAARRqw6Dlj6qbg1Ujtp","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"array([[-1.59621672, -1.0567355 ],\n       [-1.0567355 , -0.82189343]])","content_type":"text/plain"}}}],"key":"VGIddZuIl3"}],"key":"LrdKq1BCc7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def density2fock(P: np.ndarray) -> np.ndarray:\n    \"\"\"密度行列からFock行列を計算する関数\n\n    Parameters\n    ----------\n    P : np.ndarray\n        密度行列\n\n    Returns\n    -------\n    np.ndarray\n        Fock行列\n    \"\"\"\n    G = calculate_coulomb_energy_matrix(\n        P\n    ) - 0.5 * calculate_exchange_energy_matrix(P)\n    return H + G\n\n\ndensity2fock(P)","key":"hC4giu1LqR"},{"type":"output","id":"cnVCX91DedGxFv4CvtRxJ","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"array([[-1.59621672, -1.0567355 ],\n       [-1.0567355 , -0.82189343]])","content_type":"text/plain"}}}],"key":"fzo8s8q6P2"}],"key":"E2MEIZ9k4h"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"RHFエネルギーの計算","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LGNa8REBqm"}],"identifier":"rhf","label":"RHFエネルギーの計算","html_id":"rhf","implicit":true,"key":"xVBsYHyvRe"}],"key":"AvpukezC5c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"E_0 = 0.5 * np.sum(P * (H + F))\n\"\"\"ハミルトニアンに対するRHFエネルギー\"\"\"\nE_0","key":"CsOH6L2qFx"},{"type":"output","id":"EtZQCxBMGsZd6dDQuTc5t","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"-4.251121986217489","content_type":"text/plain"}}}],"key":"FnFWX4Uis3"}],"key":"lEBhVsLdkk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"E_tot = E_0 + V_nuc\n\"\"\"RHF全エネルギー\"\"\"\nE_tot","key":"T8EwES00vE"},{"type":"output","id":"XeYKnYvJJHvZP_EWIRyr6","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"-2.8225505576460606","content_type":"text/plain"}}}],"key":"TcZr3UI8CA"}],"key":"lqzDU4c8fZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def calculate_total_energy(P: np.ndarray) -> float:\n    \"\"\"全エネルギーを計算する関数\n\n    Parameters\n    ----------\n    P : np.ndarray\n        密度行列\n\n    Returns\n    -------\n    float\n        全エネルギー\n    \"\"\"\n    F = density2fock(P)\n    return 0.5 * np.sum(P * (H + F)) + V_nuc\n\n\ncalculate_total_energy(P)","key":"Wy9S75LUEl"},{"type":"output","id":"yXVXORUMA9-2E5Ei5_0gI","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"-2.8225505576460606","content_type":"text/plain"}}}],"key":"mqH8dHlD11"}],"key":"BN3a68mPbT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Roothan-hall方程式の解法","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gZ9usFPIty"}],"identifier":"roothan-hall","label":"Roothan-hall方程式の解法","html_id":"roothan-hall","implicit":true,"key":"Oera8BzLpZ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"基本的には","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BydBS7MKKx"},{"type":"link","url":"#fock%E8%A1%8C%E5%88%97%E3%81%AE%E8%A8%88%E7%AE%97","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Fock行列を求める","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HQ5Gko2LJv"}],"urlSource":"#fock%E8%A1%8C%E5%88%97%E3%81%AE%E8%A8%88%E7%AE%97","key":"Ou6fp7d3Z2"},{"type":"text","value":"から","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wnGSCnSnCB"},{"type":"link","url":"#rhf%E3%82%A8%E3%83%8D%E3%83%AB%E3%82%AE%E3%83%BC%E3%81%AE%E8%A8%88%E7%AE%97","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"RHFエネルギーの計算","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iTUlZmvyDO"}],"urlSource":"#rhf%E3%82%A8%E3%83%8D%E3%83%AB%E3%82%AE%E3%83%BC%E3%81%AE%E8%A8%88%E7%AE%97","key":"RlDiL2I3V6"},{"type":"text","value":"までを繰り返して、収束要件を満たしたら終わり。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BNKqyhZ43x"}],"key":"GgI1eugYun"}],"key":"vqw0k2ER4b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def scf_cycle(\n    P: np.ndarray, threshold: float = 1e-4\n) -> tuple[float, np.ndarray]:\n    \"\"\"SCFサイクルを行う関数\n\n    Parameters\n    ----------\n    P : np.ndarray\n        密度行列\n\n    Returns\n    -------\n    tuple[float, np.ndarray]\n        全エネルギーと密度行列\n    \"\"\"\n    # 初期化\n    E_tot_prev = np.inf\n    # 全エネルギー\n    E_tot = calculate_total_energy(P)\n    # 収束判定 (全エネルギーの変化量が閾値以下になるまで繰り返す)\n    while (E_tot_prev - E_tot) > threshold:\n        print(f\"{E_tot=}\")\n        # 全エネルギーを保存\n        E_tot_prev = E_tot\n        # 密度行列からFock行列を計算\n        F = density2fock(P)\n        # 直交化基底に対するFock行列\n        F_prime = X.T @ F @ X\n        # Fock行列をユニタリ対角化して、(軌道エネルギーと) 分子軌道係数行列を求める\n        _, C_prime = unitary_diagonalization(F_prime)\n        # 分子軌道係数行列を元の基底に戻す\n        C = X @ C_prime\n        # 密度行列を計算\n        P = calculate_density_matrix(C)\n        # 全エネルギーを計算\n        E_tot = calculate_total_energy(P)\n    return E_tot, P","key":"WzOJk4LMju"},{"type":"output","id":"6k9r3FepIbTV0p6-xeG29","data":[],"key":"kAlwRkVXDY"}],"key":"pGRT8j9fNh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"energy_total_opt, P_opt = scf_cycle(P)\nprint(f\"{energy_total_opt=}\")\nprint(f\"{P_opt=}\")","key":"E12mFc4tV6"},{"type":"output","id":"4bWlpoaAx2EnBkQCNP2xI","data":[{"name":"stdout","output_type":"stream","text":"E_tot=-2.8225505576460606\nE_tot=-2.864445821020837\nE_tot=-2.8658389239085054\nenergy_total_opt=-2.865873981640341\nP_opt=array([[1.54690179, 0.3381835 ],\n       [0.3381835 , 0.07393364]])\n"}],"key":"OmdJjNeGso"}],"key":"vdE1JfjEzE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"分子物性の計算","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yxbxo8wr3c"}],"identifier":"id","label":"分子物性の計算","html_id":"id-5","implicit":true,"key":"p7ywkU81PZ"}],"key":"RRdXxEDOlv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Mullikenの電荷解析","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T4dDbrxwBV"}],"key":"VNPYzNJAME"},{"type":"math","value":"N_A^\\mathrm{Mul} = \\sum_{\\mu \\in A} \\sum_{\\nu} P_{\\mu \\nu} S_{\\nu \\mu} = \\sum_{\\mu \\in A} (\\rm{PS})_{\\mu \\mu} \\tag{4.53}","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><msubsup><mi>N</mi><mi>A</mi><mrow><mi mathvariant=\"normal\">M</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">l</mi></mrow></msubsup><mo>=</mo><munder><mo>∑</mo><mrow><mi>μ</mi><mo>∈</mo><mi>A</mi></mrow></munder><munder><mo>∑</mo><mi>ν</mi></munder><msub><mi>P</mi><mrow><mi>μ</mi><mi>ν</mi></mrow></msub><msub><mi>S</mi><mrow><mi>ν</mi><mi>μ</mi></mrow></msub><mo>=</mo><munder><mo>∑</mo><mrow><mi>μ</mi><mo>∈</mo><mi>A</mi></mrow></munder><mo stretchy=\"false\">(</mo><mrow><mrow><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">S</mi></mrow><msub><mo stretchy=\"false\">)</mo><mrow><mi>μ</mi><mi>μ</mi></mrow></msub></mrow></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(4.53)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">N_A^\\mathrm{Mul} = \\sum_{\\mu \\in A} \\sum_{\\nu} P_{\\mu \\nu} S_{\\nu \\mu} = \\sum_{\\mu \\in A} (\\rm{PS})_{\\mu \\mu} \\tag{4.53}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1461em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">Mul</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4804em;vertical-align:-1.4304em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8557em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">μ</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\">A</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4304em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.9em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">ν</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.06366em;\">μν</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">νμ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4804em;vertical-align:-1.4304em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8557em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">μ</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\">A</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4304em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">PS</span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">μμ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"strut\" style=\"height:2.4804em;vertical-align:-1.4304em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">4.53</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"7","key":"mK7Qvnj4fM"}],"key":"vb6FoiVlEC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N_He = (P_opt @ S)[0, 0]\n\"\"\"Heの電子数\"\"\"\nN_H = (P_opt @ S)[1, 1]\n\"\"\"Hの電子数\"\"\"\nprint(f\"{N_He=}\")\nprint(f\"{N_H=}\")","key":"rgU5txlZSs"},{"type":"output","id":"DkO9Ed2FiYdTeWYqclMl0","data":[{"name":"stdout","output_type":"stream","text":"N_He=1.7364840755636173\nN_H=0.26351592443638283\n"}],"key":"CRK49uDsD4"}],"key":"NJs079Uc6g"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"よって、Mulliken電荷は、","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ewc8QzkMtr"}],"key":"FN669LD4UV"},{"type":"math","value":"Q_A = Z_A - N_A^\\mathrm{mul} \\tag{4.54}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><msub><mi>Q</mi><mi>A</mi></msub><mo>=</mo><msub><mi>Z</mi><mi>A</mi></msub><mo>−</mo><msubsup><mi>N</mi><mi>A</mi><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">l</mi></mrow></msubsup></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(4.54)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">Q_A = Z_A - N_A^\\mathrm{mul} \\tag{4.54}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1461em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">mul</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">4.54</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"8","key":"LJ1mzALjwC"},{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"より、","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mEn68Tk7la"}],"key":"H6EqkjFEZq"}],"key":"wBIMd7kE7H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Q_He = Z_He - N_He\n\"\"\"Heの電荷\"\"\"\nQ_H = Z_H - N_H\n\"\"\"Hの電荷\"\"\"\nprint(f\"{Q_He=}\")\nprint(f\"{Q_H=}\")","key":"NurznVpGhQ"},{"type":"output","id":"Gmn-R2X_MDk57Q1fHyv4w","data":[{"name":"stdout","output_type":"stream","text":"Q_He=0.2635159244363827\nQ_H=0.7364840755636172\n"}],"key":"eiOV3HHLaf"}],"key":"uh1YnDUKiB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"epsilon_opt, C_prime_opt = unitary_diagonalization(\n    X.T @ density2fock(P_opt) @ X\n)\nC_opt = X @ C_prime_opt\nprint(f\"{epsilon_opt=}\")\nprint(f\"{C_opt=}\")","key":"WIRnuVAs6K"},{"type":"output","id":"m40gSBjEfBPP3jZARE_YB","data":[{"name":"stdout","output_type":"stream","text":"epsilon_opt=array([[-1.67213202,  0.        ],\n       [ 0.        , -0.15970469]])\nC_opt=array([[ 0.8790552 ,  0.82797527],\n       [ 0.19285139, -1.19209456]])\n"}],"key":"wF5NSmjoQh"}],"key":"AsNEgMXnJZ"}],"key":"jMONDZJ8LD"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"手で解く量子化学 手で解く課題","url":"/","group":"手で解く量子化学 手で解く課題"},"next":{"title":"対象分子の設定","url":"/tedetoku-kadai-1-5-1","group":"手で解く量子化学 手で解く課題"}}},"domain":"http://localhost:3000"}